{"ast":null,"code":"var _jsxFileName = \"/Users/Angelota/Library/Mobile Documents/com~apple~CloudDocs/Desktop/UCM/TFG INFOR/TFG FINAL/TFGI-Plataforma-blockchain-para-visualizar-la-reputacion-de-empresas-sobre-casos-de-discriminacion/cliente/src/views/pages/tfgInfo/DonationButtonCard.js\",\n    _s = $RefreshSig$();\n\nimport PropTypes from 'prop-types'; // material-ui\n\nimport { styled, useTheme } from '@mui/material/styles';\nimport { Avatar, Box, List, ListItem, ListItemAvatar, ListItemText, Typography, TextField, Button } from '@mui/material';\nimport Dialog, { DialogProps } from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport FormControl from '@mui/material/FormControl';\nimport InputLabel from '@mui/material/InputLabel';\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\nimport { ethers } from \"ethers\";\nimport { context } from '../../../contextProvider.js';\nimport React, { useState, useEffect, useContext } from 'react'; // project imports\n\nimport MainCard from 'ui-component/cards/MainCard';\nimport TotalIncomeCard from 'ui-component/cards/Skeleton/TotalIncomeCard'; // assets\n\nimport MoodIcon from '@mui/icons-material/Mood'; // styles\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CardWrapper = styled(MainCard)(_ref => {\n  let {\n    theme\n  } = _ref;\n  return {\n    backgroundColor: theme.palette.primary.dark,\n    color: theme.palette.primary.light,\n    overflow: 'hidden',\n    position: 'relative',\n    '&:after': {\n      content: '\"\"',\n      position: 'absolute',\n      width: 210,\n      height: 210,\n      background: `linear-gradient(210.04deg, ${theme.palette.primary[200]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,\n      borderRadius: '50%',\n      top: -30,\n      right: -180\n    },\n    '&:before': {\n      content: '\"\"',\n      position: 'absolute',\n      width: 210,\n      height: 210,\n      background: `linear-gradient(140.9deg, ${theme.palette.primary[200]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,\n      borderRadius: '50%',\n      top: -160,\n      right: -130\n    }\n  };\n}); // ==============================|| DASHBOARD - TOTAL INCOME DARK CARD ||============================== //\n\nconst DonationButtonCard = _ref2 => {\n  _s();\n\n  let {\n    isLoading,\n    addDonation\n  } = _ref2;\n  const theme = useTheme();\n  const [amount, setAmount] = React.useState(\"\"); //cantidad a donar en ethers\n\n  const [open, setOpen] = React.useState(false);\n  const [unidades, setUnidades] = React.useState(\"wei\");\n  const Context = React.useContext(context);\n\n  const handleClick = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  const handleChangeUnities = e => {\n    setUnidades(e.target.value);\n  };\n\n  const handleChangeAmount = e => {\n    setAmount(e.target.value);\n  };\n\n  const handleDonation = async e => {\n    try {\n      if (!window.ethereum) //Para ver si el usuario tiene cartera\n        throw new Error(\"No se encontro cartera de metamask.\");\n      await window.ethereum.send(\"eth_requestAccounts\");\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n      console.log(\"enviando transaccion\");\n      const tx = await signer.sendTransaction({\n        to: process.env.REACT_APP_ADDRESS,\n        value: ethers.utils.parseUnits(amount, unidades),\n        gasPrice: signer.getGasPrice(),\n        gasLimit: 100000\n      });\n      setOpen(false);\n      const amountInWeis = ethers.utils.parseUnits(amount, unidades);\n      const amountInEthers = parseFloat(ethers.utils.formatEther(amountInWeis));\n      addDonation(amountInEthers); //Actualizar contrato inteligente:\n\n      const transaction = Context.contract.methods.addAmountDonated(amountInEthers * 10000);\n      const ty = {\n        to: process.env.REACT_APP_CONTRACT_ADDRESS,\n        //Dirección del contrato\n        data: transaction.encodeABI(),\n        //\n        gas: await transaction.estimateGas({\n          from: process.env.REACT_APP_ADDRESS\n        }),\n        //Se estima el coste en gas\n        gasPrice: (await Context.web3.eth.getGasPrice()) * 1.10,\n        //Precio del gas\n        gaslimit: 0x1000000,\n        //Limite de gas que se puede gastar\n        value: 0 //No se va a realizar una transferencia\n\n      };\n      const signedTx = await Context.web3.eth.accounts.signTransaction(ty, process.env.REACT_APP_ETH_PRIVATE_KEY);\n      const tyL = await Context.web3.eth.sendSignedTransaction(signedTx.rawTransaction);\n      console.log(tyL);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isLoading ? /*#__PURE__*/_jsxDEV(TotalIncomeCard, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(CardWrapper, {\n      border: false,\n      content: false,\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          p: 2\n        },\n        onClick: handleClick,\n        children: /*#__PURE__*/_jsxDEV(List, {\n          sx: {\n            py: 0\n          },\n          children: /*#__PURE__*/_jsxDEV(ListItem, {\n            alignItems: \"center\",\n            disableGutters: true,\n            sx: {\n              py: 0\n            },\n            children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n              children: /*#__PURE__*/_jsxDEV(Avatar, {\n                variant: \"rounded\",\n                sx: { ...theme.typography.commonAvatar,\n                  ...theme.typography.largeAvatar,\n                  backgroundColor: theme.palette.primary[800],\n                  color: '#fff'\n                },\n                children: /*#__PURE__*/_jsxDEV(MoodIcon, {\n                  fontSize: \"inherit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 139,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 130,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n              sx: {\n                py: 0,\n                mt: 0.45,\n                mb: 0.45\n              },\n              primary: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h2\",\n                sx: {\n                  color: '#fff'\n                },\n                children: \"DONAR\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 41\n              }, this),\n              secondary: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"subtitle2\",\n                sx: {\n                  color: 'primary.light',\n                  mt: 0.25\n                },\n                children: \"Gracias por tu ayuda\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n        open: open,\n        onClose: handleClose,\n        disableEscapeKeyDown: false,\n        \"aria-labelledby\": \"alert-dialog-title\",\n        \"aria-describedby\": \"alert-dialog-description\",\n        children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n          children: \" Introduzca cantidad a donar \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            noValidate: true,\n            component: \"form\",\n            sx: {\n              display: 'flex',\n              flexDirection: 'column',\n              m: 'auto',\n              width: 'fit-content'\n            },\n            children: [/*#__PURE__*/_jsxDEV(FormControl, {\n              sx: {\n                mt: 2,\n                minWidth: 120\n              },\n              children: [/*#__PURE__*/_jsxDEV(InputLabel, {\n                htmlFor: \"unidades\",\n                children: \"Unidades\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                autoFocus: true,\n                value: unidades,\n                onChange: handleChangeUnities,\n                label: \"maxWidth\",\n                inputProps: {\n                  name: 'unidades',\n                  id: 'unidades'\n                },\n                children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: \"wei\",\n                  children: \"wei\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 193,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: \"gwei\",\n                  children: \"gwei\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                  value: \"ether\",\n                  children: \"ether\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 195,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(TextField, {\n              id: \"outlined-basic\",\n              label: \"Amount\",\n              value: amount,\n              onChange: handleChangeAmount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleDonation,\n            children: \"Donar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleClose,\n            children: \"Cerrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n};\n\n_s(DonationButtonCard, \"JvufaFtKGdOTBIVn09rFX5jwp+4=\", false, function () {\n  return [useTheme];\n});\n\n_c = DonationButtonCard;\nDonationButtonCard.propTypes = {\n  isLoading: PropTypes.bool\n};\nexport default DonationButtonCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"DonationButtonCard\");","map":{"version":3,"sources":["/Users/Angelota/Library/Mobile Documents/com~apple~CloudDocs/Desktop/UCM/TFG INFOR/TFG FINAL/TFGI-Plataforma-blockchain-para-visualizar-la-reputacion-de-empresas-sobre-casos-de-discriminacion/cliente/src/views/pages/tfgInfo/DonationButtonCard.js"],"names":["PropTypes","styled","useTheme","Avatar","Box","List","ListItem","ListItemAvatar","ListItemText","Typography","TextField","Button","Dialog","DialogProps","DialogActions","DialogContent","DialogContentText","DialogTitle","FormControl","InputLabel","MenuItem","Select","ethers","context","React","useState","useEffect","useContext","MainCard","TotalIncomeCard","MoodIcon","CardWrapper","theme","backgroundColor","palette","primary","dark","color","light","overflow","position","content","width","height","background","borderRadius","top","right","DonationButtonCard","isLoading","addDonation","amount","setAmount","open","setOpen","unidades","setUnidades","Context","handleClick","handleClose","handleChangeUnities","e","target","value","handleChangeAmount","handleDonation","window","ethereum","Error","send","provider","providers","Web3Provider","signer","getSigner","console","log","tx","sendTransaction","to","process","env","REACT_APP_ADDRESS","utils","parseUnits","gasPrice","getGasPrice","gasLimit","amountInWeis","amountInEthers","parseFloat","formatEther","transaction","contract","methods","addAmountDonated","ty","REACT_APP_CONTRACT_ADDRESS","data","encodeABI","gas","estimateGas","from","web3","eth","gaslimit","signedTx","accounts","signTransaction","REACT_APP_ETH_PRIVATE_KEY","tyL","sendSignedTransaction","rawTransaction","err","p","py","typography","commonAvatar","largeAvatar","mt","mb","display","flexDirection","m","minWidth","name","id","propTypes","bool"],"mappings":";;;AAAA,OAAOA,SAAP,MAAsB,YAAtB,C,CAEA;;AACA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,sBAAjC;AACA,SAASC,MAAT,EAAiBC,GAAjB,EAAsBC,IAAtB,EAA4BC,QAA5B,EAAsCC,cAAtC,EAAsDC,YAAtD,EAAoEC,UAApE,EAAgFC,SAAhF,EAA2FC,MAA3F,QAAyG,eAAzG;AACA,OAAOC,MAAP,IAAiBC,WAAjB,QAAoC,sBAApC;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,OAAOC,aAAP,MAA0B,6BAA1B;AACA,OAAOC,iBAAP,MAA8B,iCAA9B;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AAEA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AAEA,SAASC,MAAT,QAAuB,QAAvB;AACA,SAASC,OAAT,QAAwB,6BAAxB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD,C,CAEA;;AACA,OAAOC,QAAP,MAAqB,6BAArB;AACA,OAAOC,eAAP,MAA4B,6CAA5B,C,CAEA;;AACA,OAAOC,QAAP,MAAqB,0BAArB,C,CACA;;;;AACA,MAAMC,WAAW,GAAG9B,MAAM,CAAC2B,QAAD,CAAN,CAAiB;AAAA,MAAC;AAAEI,IAAAA;AAAF,GAAD;AAAA,SAAgB;AACjDC,IAAAA,eAAe,EAAED,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsBC,IADU;AAEjDC,IAAAA,KAAK,EAAEL,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsBG,KAFoB;AAGjDC,IAAAA,QAAQ,EAAE,QAHuC;AAIjDC,IAAAA,QAAQ,EAAE,UAJuC;AAKjD,eAAW;AACPC,MAAAA,OAAO,EAAE,IADF;AAEPD,MAAAA,QAAQ,EAAE,UAFH;AAGPE,MAAAA,KAAK,EAAE,GAHA;AAIPC,MAAAA,MAAM,EAAE,GAJD;AAKPC,MAAAA,UAAU,EAAG,8BAA6BZ,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsB,GAAtB,CAA2B,0CAL9D;AAMPU,MAAAA,YAAY,EAAE,KANP;AAOPC,MAAAA,GAAG,EAAE,CAAC,EAPC;AAQPC,MAAAA,KAAK,EAAE,CAAC;AARD,KALsC;AAejD,gBAAY;AACRN,MAAAA,OAAO,EAAE,IADD;AAERD,MAAAA,QAAQ,EAAE,UAFF;AAGRE,MAAAA,KAAK,EAAE,GAHC;AAIRC,MAAAA,MAAM,EAAE,GAJA;AAKRC,MAAAA,UAAU,EAAG,6BAA4BZ,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsB,GAAtB,CAA2B,0CAL5D;AAMRU,MAAAA,YAAY,EAAE,KANN;AAORC,MAAAA,GAAG,EAAE,CAAC,GAPE;AAQRC,MAAAA,KAAK,EAAE,CAAC;AARA;AAfqC,GAAhB;AAAA,CAAjB,CAApB,C,CA2BA;;AAEA,MAAMC,kBAAkB,GAAG,SAAgC;AAAA;;AAAA,MAA/B;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,GAA+B;AACvD,QAAMlB,KAAK,GAAG9B,QAAQ,EAAtB;AAEA,QAAM,CAACiD,MAAD,EAASC,SAAT,IAAsB5B,KAAK,CAACC,QAAN,CAAe,EAAf,CAA5B,CAHuD,CAGP;;AAChD,QAAM,CAAC4B,IAAD,EAAOC,OAAP,IAAkB9B,KAAK,CAACC,QAAN,CAAe,KAAf,CAAxB;AACA,QAAM,CAAC8B,QAAD,EAAWC,WAAX,IAA0BhC,KAAK,CAACC,QAAN,CAAe,KAAf,CAAhC;AAEA,QAAMgC,OAAO,GAAGjC,KAAK,CAACG,UAAN,CAAiBJ,OAAjB,CAAhB;;AAEA,QAAMmC,WAAW,GAAG,MAAM;AACtBJ,IAAAA,OAAO,CAAC,IAAD,CAAP;AACH,GAFD;;AAIA,QAAMK,WAAW,GAAG,MAAM;AACvBL,IAAAA,OAAO,CAAC,KAAD,CAAP;AACF,GAFD;;AAIA,QAAMM,mBAAmB,GAAIC,CAAD,IAAO;AAC/BL,IAAAA,WAAW,CAACK,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX;AACH,GAFD;;AAIA,QAAMC,kBAAkB,GAAIH,CAAD,IAAO;AAC9BT,IAAAA,SAAS,CAACS,CAAC,CAACC,MAAF,CAASC,KAAV,CAAT;AACH,GAFD;;AAIA,QAAME,cAAc,GAAG,MAAOJ,CAAP,IAAa;AAChC,QAAG;AACC,UAAG,CAACK,MAAM,CAACC,QAAX,EAAqB;AACjB,cAAM,IAAIC,KAAJ,CAAU,qCAAV,CAAN;AACJ,YAAMF,MAAM,CAACC,QAAP,CAAgBE,IAAhB,CAAqB,qBAArB,CAAN;AACA,YAAMC,QAAQ,GAAG,IAAIhD,MAAM,CAACiD,SAAP,CAAiBC,YAArB,CAAkCN,MAAM,CAACC,QAAzC,CAAjB;AACA,YAAMM,MAAM,GAAGH,QAAQ,CAACI,SAAT,EAAf;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACA,YAAMC,EAAE,GAAG,MAAMJ,MAAM,CAACK,eAAP,CAAuB;AACpCC,QAAAA,EAAE,EAAEC,OAAO,CAACC,GAAR,CAAYC,iBADoB;AAEpCnB,QAAAA,KAAK,EAAGzC,MAAM,CAAC6D,KAAP,CAAaC,UAAb,CAAwBjC,MAAxB,EAAgCI,QAAhC,CAF4B;AAGpC8B,QAAAA,QAAQ,EAAEZ,MAAM,CAACa,WAAP,EAH0B;AAIpCC,QAAAA,QAAQ,EAAG;AAJyB,OAAvB,CAAjB;AAMAjC,MAAAA,OAAO,CAAC,KAAD,CAAP;AACA,YAAMkC,YAAY,GAAGlE,MAAM,CAAC6D,KAAP,CAAaC,UAAb,CAAwBjC,MAAxB,EAAgCI,QAAhC,CAArB;AACA,YAAMkC,cAAc,GAAGC,UAAU,CAACpE,MAAM,CAAC6D,KAAP,CAAaQ,WAAb,CAAyBH,YAAzB,CAAD,CAAjC;AACAtC,MAAAA,WAAW,CAACuC,cAAD,CAAX,CAhBD,CAiBC;;AACA,YAAMG,WAAW,GAAGnC,OAAO,CAACoC,QAAR,CAAiBC,OAAjB,CAAyBC,gBAAzB,CAA0CN,cAAc,GAAC,KAAzD,CAApB;AAEA,YAAMO,EAAE,GAAG;AACPjB,QAAAA,EAAE,EAAQC,OAAO,CAACC,GAAR,CAAYgB,0BADf;AAC2C;AAClDC,QAAAA,IAAI,EAAMN,WAAW,CAACO,SAAZ,EAFH;AAEiC;AACxCC,QAAAA,GAAG,EAAO,MAAMR,WAAW,CAACS,WAAZ,CAAwB;AAACC,UAAAA,IAAI,EAAEtB,OAAO,CAACC,GAAR,CAAYC;AAAnB,SAAxB,CAHT;AAG2E;AAClFG,QAAAA,QAAQ,EAAE,OAAM5B,OAAO,CAAC8C,IAAR,CAAaC,GAAb,CAAiBlB,WAAjB,EAAN,IAAuC,IAJ1C;AAIkD;AACzDmB,QAAAA,QAAQ,EAAE,SALH;AAKgB;AACvB1C,QAAAA,KAAK,EAAK,CANH,CAMQ;;AANR,OAAX;AAQA,YAAM2C,QAAQ,GAAI,MAAMjD,OAAO,CAAC8C,IAAR,CAAaC,GAAb,CAAiBG,QAAjB,CAA0BC,eAA1B,CAA0CZ,EAA1C,EAA8ChB,OAAO,CAACC,GAAR,CAAY4B,yBAA1D,CAAxB;AACA,YAAMC,GAAG,GAAG,MAAMrD,OAAO,CAAC8C,IAAR,CAAaC,GAAb,CAAiBO,qBAAjB,CAAuCL,QAAQ,CAACM,cAAhD,CAAlB;AACArC,MAAAA,OAAO,CAACC,GAAR,CAAYkC,GAAZ;AACH,KA/BD,CAgCA,OAAOG,GAAP,EAAY;AACRtC,MAAAA,OAAO,CAACC,GAAR,CAAYqC,GAAZ;AACH;AACJ,GApCD;;AAsCA,sBACI;AAAA,cACKhE,SAAS,gBACN,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA,YADM,gBAGN,QAAC,WAAD;AAAa,MAAA,MAAM,EAAE,KAArB;AAA4B,MAAA,OAAO,EAAE,KAArC;AAAA,8BACI,QAAC,GAAD;AAAK,QAAA,EAAE,EAAE;AAAEiE,UAAAA,CAAC,EAAE;AAAL,SAAT;AAAoB,QAAA,OAAO,EAAIxD,WAA/B;AAAA,+BACI,QAAC,IAAD;AAAM,UAAA,EAAE,EAAE;AAAEyD,YAAAA,EAAE,EAAE;AAAN,WAAV;AAAA,iCACI,QAAC,QAAD;AAAU,YAAA,UAAU,EAAC,QAArB;AAA8B,YAAA,cAAc,MAA5C;AAA6C,YAAA,EAAE,EAAE;AAAEA,cAAAA,EAAE,EAAE;AAAN,aAAjD;AAAA,oCACI,QAAC,cAAD;AAAA,qCACI,QAAC,MAAD;AACI,gBAAA,OAAO,EAAC,SADZ;AAEI,gBAAA,EAAE,EAAE,EACA,GAAGnF,KAAK,CAACoF,UAAN,CAAiBC,YADpB;AAEA,qBAAGrF,KAAK,CAACoF,UAAN,CAAiBE,WAFpB;AAGArF,kBAAAA,eAAe,EAAED,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsB,GAAtB,CAHjB;AAIAE,kBAAAA,KAAK,EAAE;AAJP,iBAFR;AAAA,uCASI,QAAC,QAAD;AAAU,kBAAA,QAAQ,EAAC;AAAnB;AAAA;AAAA;AAAA;AAAA;AATJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,oBADJ,eAcI,QAAC,YAAD;AACI,cAAA,EAAE,EAAE;AACA8E,gBAAAA,EAAE,EAAE,CADJ;AAEAI,gBAAAA,EAAE,EAAE,IAFJ;AAGAC,gBAAAA,EAAE,EAAE;AAHJ,eADR;AAMI,cAAA,OAAO,eACH,QAAC,UAAD;AAAY,gBAAA,OAAO,EAAC,IAApB;AAAyB,gBAAA,EAAE,EAAE;AAAEnF,kBAAAA,KAAK,EAAE;AAAT,iBAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAPR;AAWI,cAAA,SAAS,eACL,QAAC,UAAD;AAAY,gBAAA,OAAO,EAAC,WAApB;AAAgC,gBAAA,EAAE,EAAE;AAAEA,kBAAAA,KAAK,EAAE,eAAT;AAA0BkF,kBAAAA,EAAE,EAAE;AAA9B,iBAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAZR;AAAA;AAAA;AAAA;AAAA,oBAdJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAqCI,QAAC,MAAD;AACA,QAAA,IAAI,EAAElE,IADN;AAEA,QAAA,OAAO,EAAEM,WAFT;AAGA,QAAA,oBAAoB,EAAI,KAHxB;AAIA,2BAAgB,oBAJhB;AAKA,4BAAiB,0BALjB;AAAA,gCAOI,QAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPJ,eAQI,QAAC,aAAD;AAAA,iCACA,QAAC,GAAD;AACI,YAAA,UAAU,MADd;AAEI,YAAA,SAAS,EAAC,MAFd;AAGI,YAAA,EAAE,EAAE;AACJ8D,cAAAA,OAAO,EAAE,MADL;AAEJC,cAAAA,aAAa,EAAE,QAFX;AAGJC,cAAAA,CAAC,EAAE,MAHC;AAIJjF,cAAAA,KAAK,EAAE;AAJH,aAHR;AAAA,oCAUI,QAAC,WAAD;AAAa,cAAA,EAAE,EAAE;AAAE6E,gBAAAA,EAAE,EAAE,CAAN;AAASK,gBAAAA,QAAQ,EAAE;AAAnB,eAAjB;AAAA,sCACA,QAAC,UAAD;AAAY,gBAAA,OAAO,EAAC,UAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADA,eAEA,QAAC,MAAD;AACI,gBAAA,SAAS,MADb;AAEI,gBAAA,KAAK,EAAErE,QAFX;AAGI,gBAAA,QAAQ,EAAEK,mBAHd;AAII,gBAAA,KAAK,EAAC,UAJV;AAKI,gBAAA,UAAU,EAAE;AACZiE,kBAAAA,IAAI,EAAE,UADM;AAEZC,kBAAAA,EAAE,EAAE;AAFQ,iBALhB;AAAA,wCAUI,QAAC,QAAD;AAAU,kBAAA,KAAK,EAAC,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAVJ,eAWI,QAAC,QAAD;AAAU,kBAAA,KAAK,EAAC,MAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAXJ,eAYI,QAAC,QAAD;AAAU,kBAAA,KAAK,EAAC,OAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAZJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBAFA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAVJ,eA2BI;AAAA;AAAA;AAAA;AAAA,oBA3BJ,eA4BI,QAAC,SAAD;AAAW,cAAA,EAAE,EAAC,gBAAd;AAA+B,cAAA,KAAK,EAAC,QAArC;AAA8C,cAAA,KAAK,EAAI3E,MAAvD;AAA+D,cAAA,QAAQ,EAAIa;AAA3E;AAAA;AAAA;AAAA;AAAA,oBA5BJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,gBARJ,eAwCI,QAAC,aAAD;AAAA,kCACI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAIC,cAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAIN,WAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAxCJ;AAAA;AAAA;AAAA;AAAA;AAAA,cArCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAJR,mBADJ;AA2FH,CA1JD;;GAAMX,kB;UACY9C,Q;;;KADZ8C,kB;AA4JNA,kBAAkB,CAAC+E,SAAnB,GAA+B;AAC3B9E,EAAAA,SAAS,EAAEjD,SAAS,CAACgI;AADM,CAA/B;AAIA,eAAehF,kBAAf","sourcesContent":["import PropTypes from 'prop-types';\n\n// material-ui\nimport { styled, useTheme } from '@mui/material/styles';\nimport { Avatar, Box, List, ListItem, ListItemAvatar, ListItemText, Typography, TextField, Button } from '@mui/material';\nimport Dialog, { DialogProps } from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport FormControl from '@mui/material/FormControl';\nimport InputLabel from '@mui/material/InputLabel';\n\nimport MenuItem from '@mui/material/MenuItem';\nimport Select from '@mui/material/Select';\n\nimport { ethers } from \"ethers\";\nimport { context } from '../../../contextProvider.js';\nimport React, { useState, useEffect, useContext } from 'react';\n\n// project imports\nimport MainCard from 'ui-component/cards/MainCard';\nimport TotalIncomeCard from 'ui-component/cards/Skeleton/TotalIncomeCard';\n\n// assets\nimport MoodIcon from '@mui/icons-material/Mood';\n// styles\nconst CardWrapper = styled(MainCard)(({ theme }) => ({\n    backgroundColor: theme.palette.primary.dark,\n    color: theme.palette.primary.light,\n    overflow: 'hidden',\n    position: 'relative',\n    '&:after': {\n        content: '\"\"',\n        position: 'absolute',\n        width: 210,\n        height: 210,\n        background: `linear-gradient(210.04deg, ${theme.palette.primary[200]} -50.94%, rgba(144, 202, 249, 0) 83.49%)`,\n        borderRadius: '50%',\n        top: -30,\n        right: -180\n    },\n    '&:before': {\n        content: '\"\"',\n        position: 'absolute',\n        width: 210,\n        height: 210,\n        background: `linear-gradient(140.9deg, ${theme.palette.primary[200]} -14.02%, rgba(144, 202, 249, 0) 77.58%)`,\n        borderRadius: '50%',\n        top: -160,\n        right: -130\n    }\n}));\n\n// ==============================|| DASHBOARD - TOTAL INCOME DARK CARD ||============================== //\n\nconst DonationButtonCard = ({ isLoading, addDonation }) => {\n    const theme = useTheme();\n\n    const [amount, setAmount] = React.useState(\"\"); //cantidad a donar en ethers\n    const [open, setOpen] = React.useState(false);\n    const [unidades, setUnidades] = React.useState(\"wei\");\n    \n    const Context = React.useContext(context);\n\n    const handleClick = () => {\n        setOpen(true);\n    };\n\n    const handleClose = () => {\n       setOpen(false);\n    };\n\n    const handleChangeUnities = (e) => {\n        setUnidades(e.target.value);\n    }\n\n    const handleChangeAmount = (e) => {\n        setAmount(e.target.value);\n    }\n\n    const handleDonation = async (e) => {\n        try{\n            if(!window.ethereum) //Para ver si el usuario tiene cartera\n                throw new Error(\"No se encontro cartera de metamask.\");\n            await window.ethereum.send(\"eth_requestAccounts\");\n            const provider = new ethers.providers.Web3Provider(window.ethereum);\n            const signer = provider.getSigner();\n            console.log(\"enviando transaccion\")\n            const tx = await signer.sendTransaction({\n                to: process.env.REACT_APP_ADDRESS,\n                value:  ethers.utils.parseUnits(amount, unidades),\n                gasPrice: signer.getGasPrice(),\n                gasLimit : 100000\n            });\n            setOpen(false);\n            const amountInWeis = ethers.utils.parseUnits(amount, unidades);\n            const amountInEthers = parseFloat(ethers.utils.formatEther(amountInWeis));\n            addDonation(amountInEthers);\n            //Actualizar contrato inteligente:\n            const transaction = Context.contract.methods.addAmountDonated(amountInEthers*10000);\n\n            const ty = {\n                to      : process.env.REACT_APP_CONTRACT_ADDRESS, //Dirección del contrato\n                data    : transaction.encodeABI(),      //\n                gas     : await transaction.estimateGas({from: process.env.REACT_APP_ADDRESS}),   //Se estima el coste en gas\n                gasPrice: await Context.web3.eth.getGasPrice() * 1.10,   //Precio del gas\n                gaslimit: 0x1000000,   //Limite de gas que se puede gastar\n                value   : 0,   //No se va a realizar una transferencia\n            };\n            const signedTx  = await Context.web3.eth.accounts.signTransaction(ty, process.env.REACT_APP_ETH_PRIVATE_KEY);\n            const tyL = await Context.web3.eth.sendSignedTransaction(signedTx.rawTransaction);\n            console.log(tyL);\n        }\n        catch (err) {\n            console.log(err);\n        }\n    }\n\n    return (\n        <>\n            {isLoading ? (\n                <TotalIncomeCard />\n            ) : (\n                <CardWrapper border={false} content={false}>\n                    <Box sx={{ p: 2 }}  onClick = {handleClick}>\n                        <List sx={{ py: 0 }}>\n                            <ListItem alignItems=\"center\" disableGutters sx={{ py: 0 }}>\n                                <ListItemAvatar >\n                                    <Avatar\n                                        variant=\"rounded\"\n                                        sx={{\n                                            ...theme.typography.commonAvatar,\n                                            ...theme.typography.largeAvatar,\n                                            backgroundColor: theme.palette.primary[800],\n                                            color: '#fff'\n                                        }}\n                                    >\n                                        <MoodIcon fontSize=\"inherit\" />\n                                    </Avatar>\n                                </ListItemAvatar>\n                                <ListItemText\n                                    sx={{\n                                        py: 0,\n                                        mt: 0.45,\n                                        mb: 0.45\n                                    }}\n                                    primary={\n                                        <Typography variant=\"h2\" sx={{ color: '#fff' }}>\n                                            DONAR\n                                        </Typography>\n                                    }\n                                    secondary={\n                                        <Typography variant=\"subtitle2\" sx={{ color: 'primary.light', mt: 0.25 }}>\n                                            Gracias por tu ayuda \n                                        </Typography>\n                                    }\n                                />\n                            </ListItem>\n                        </List>\n                    </Box>\n                    <Dialog\n                    open={open}\n                    onClose={handleClose}\n                    disableEscapeKeyDown = {false}\n                    aria-labelledby=\"alert-dialog-title\"\n                    aria-describedby=\"alert-dialog-description\"\n                  > \n                        <DialogTitle> Introduzca cantidad a donar </DialogTitle>\n                        <DialogContent>\n                        <Box\n                            noValidate\n                            component=\"form\"\n                            sx={{\n                            display: 'flex',\n                            flexDirection: 'column',\n                            m: 'auto',\n                            width: 'fit-content',\n                            }}\n                        >\n                            <FormControl sx={{ mt: 2, minWidth: 120 }}>\n                            <InputLabel htmlFor=\"unidades\">Unidades</InputLabel>\n                            <Select\n                                autoFocus\n                                value={unidades}\n                                onChange={handleChangeUnities}\n                                label=\"maxWidth\"\n                                inputProps={{\n                                name: 'unidades',\n                                id: 'unidades',\n                                }}\n                            >\n                                <MenuItem value=\"wei\">wei</MenuItem>\n                                <MenuItem value=\"gwei\">gwei</MenuItem>\n                                <MenuItem value=\"ether\">ether</MenuItem>\n                            </Select>\n                            </FormControl>\n                            <br/>\n                            <TextField id=\"outlined-basic\" label=\"Amount\" value = {amount} onChange = {handleChangeAmount}/>\n                        </Box>\n                        </DialogContent>\n                        <DialogActions>\n                            <Button onClick = {handleDonation}>Donar</Button>\n                            <Button onClick = {handleClose}>Cerrar</Button>\n                        </DialogActions>\n                  </Dialog>\n                </CardWrapper>\n            )}\n        </>\n    );\n};\n\nDonationButtonCard.propTypes = {\n    isLoading: PropTypes.bool\n};\n\nexport default DonationButtonCard;"]},"metadata":{},"sourceType":"module"}